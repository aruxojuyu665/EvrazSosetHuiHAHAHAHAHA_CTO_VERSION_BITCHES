# GOST RAG System - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ RunPod –ó–ê–í–ï–†–®–ï–ù–û ‚úÖ

**–î–∞—Ç–∞:** 30 –æ–∫—Ç—è–±—Ä—è 2025  
**–°–µ—Ä–≤–µ—Ä:** RunPod GPU Instance (RTX 3090, 24GB VRAM)  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
```bash
ssh root@213.192.2.89 -p 40039 -i ~/.ssh/id_ed25519
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- **GPU:** NVIDIA GeForce RTX 3090 (24 GB VRAM)
- **CPU:** 32 vCPU
- **RAM:** 125 GB
- **Storage:** 199 TB –¥–æ—Å—Ç—É–ø–Ω–æ –≤ /workspace
- **OS:** Ubuntu 24.04 (Noble)
- **Python:** 3.11.14

---

## –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û

### Python –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- **–ü—É—Ç—å:** `/workspace/gost_rag/venv/`
- **Python:** 3.11.14
- **pip:** 25.3

### –ö–ª—é—á–µ–≤—ã–µ –ø–∞–∫–µ—Ç—ã
| –ü–∞–∫–µ—Ç | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|--------|------------|
| torch | 2.9.0 | Deep Learning (—Å CUDA 12.8) |
| llama-index | 0.14.6 | RAG Framework |
| llama-index-core | 0.14.6 | Core RAG —Ñ—É–Ω–∫—Ü–∏–∏ |
| llama-index-llms-openai | 0.6.6 | OpenRouter –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è |
| llama-index-embeddings-huggingface | 0.6.1 | –õ–æ–∫–∞–ª—å–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ |
| llama-index-vector-stores-milvus | 0.9.3 | Milvus –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è |
| transformers | 4.57.1 | HuggingFace Transformers |
| sentence-transformers | 5.1.2 | Sentence embeddings |
| pymilvus | 2.6.2 | Milvus Python SDK |
| milvus | 2.3.5 | Milvus Lite (embedded) |
| pandas | 2.2.3 | Data processing |
| numpy | 2.3.4 | Numerical computing |

### CUDA –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- nvidia-cublas-cu12: 12.8.4.1
- nvidia-cudnn-cu12: 9.6.0.74
- nvidia-cusparse-cu12: 12.8.4.1
- nvidia-cusolver-cu12: 11.8.4.1
- nvidia-cufft-cu12: 11.4.4.1
- nvidia-curand-cu12: 10.4.4.1
- nvidia-nccl-cu12: 2.25.3

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/workspace/gost_rag/
‚îú‚îÄ‚îÄ venv/                    # Python –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ src/                     # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ main.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ parsers/            # PDF –ø–∞—Ä—Å–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ extractors/         # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ models/             # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ rag/                # RAG —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ vector_store/       # Milvus –º–µ–Ω–µ–¥–∂–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/                # –ò—Å—Ö–æ–¥–Ω—ã–µ PDF (–ì–û–°–¢ 27772-2021)
‚îÇ   ‚îî‚îÄ‚îÄ processed/          # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ tests/                  # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ docs/                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ config.yaml             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md              # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª: `/workspace/gost_rag/config.yaml`

```yaml
embedding:
  type: local
  model: intfloat/multilingual-e5-large
  device: cuda

milvus:
  host: localhost
  port: 19530
  collection_name: gost_documents

llm:
  provider: openrouter
  model: anthropic/claude-3.5-sonnet
  api_key: ${OPENROUTER_API_KEY}
  temperature: 0.1
  max_tokens: 4096

chunking:
  chunk_size: 1000
  chunk_overlap: 200

paths:
  data_dir: /workspace/gost_rag/data
  raw_dir: /workspace/gost_rag/data/raw
  processed_dir: /workspace/gost_rag/data/processed
```

---

## –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

### 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
```bash
ssh root@213.192.2.89 -p 40039 -i ~/.ssh/id_ed25519
```

### 2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
cd /workspace/gost_rag
source venv/bin/activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
export OPENROUTER_API_KEY="your_api_key_here"
export EMBEDDING_TYPE="local"
export EMBEDDING_DEVICE="cuda"
```

### 4. –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
```bash
python -m src.main index --input data/raw --create-new
```

### 5. –ò–∑–≤–ª–µ—á—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∞—Å—Å–µ –ø—Ä–æ—á–Ω–æ—Å—Ç–∏
```bash
python -m src.main extract --class-name C235
```

### 6. –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
```bash
python -m src.main query --question "–ö–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ö–∏–º–∏—á–µ—Å–∫–æ–º—É —Å–æ—Å—Ç–∞–≤—É —Å—Ç–∞–ª–∏ –∫–ª–∞—Å—Å–∞ C235?"
```

### 7. –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```bash
python -m src.main stats
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ GPU

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å CUDA
python -c "import torch; print(f'CUDA available: {torch.cuda.is_available()}'); print(f'GPU: {torch.cuda.get_device_name(0) if torch.cuda.is_available() else \"N/A\"}')"

# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
# CUDA available: True
# GPU: NVIDIA GeForce RTX 3090
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU
```bash
nvidia-smi
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
```bash
df -h /workspace
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
```bash
free -h
```

### –ü—Ä–æ—Ü–µ—Å—Å—ã Python
```bash
ps aux | grep python
```

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API –∫–ª—é—á–∏
- –ü–æ–ª—É—á–∏—Ç—å OpenRouter API –∫–ª—é—á: https://openrouter.ai/
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `OPENROUTER_API_KEY`

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ì–û–°–¢
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å PDF —Ñ–∞–π–ª—ã –≤ data/raw/
scp -P 40039 -i ~/.ssh/id_ed25519 *.pdf root@213.192.2.89:/workspace/gost_rag/data/raw/
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```bash
# TODO: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–∑ gost_rag_web –ø—Ä–æ–µ–∫—Ç–∞
```

### 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ (systemd)
```bash
# TODO: –°–æ–∑–¥–∞—Ç—å systemd service –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: Out of Memory (OOM)
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–º–µ–Ω—å—à–∏—Ç—å batch size –≤ config.yaml
# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:
export EMBEDDING_DEVICE="cpu"
```

### –ü—Ä–æ–±–ª–µ–º–∞: CUDA not available
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã NVIDIA
nvidia-smi

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PyTorch —Å CUDA
pip install torch==2.9.0 --index-url https://download.pytorch.org/whl/cu121
```

### –ü—Ä–æ–±–ª–µ–º–∞: Milvus connection error
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# Milvus Lite —Ä–∞–±–æ—Ç–∞–µ—Ç embedded, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ milvus —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
pip list | grep milvus
```

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–∂–∏–¥–∞–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è (GPU) | –í—Ä–µ–º—è (CPU) |
|----------|-------------|-------------|
| –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è 1 PDF (50 —Å—Ç—Ä) | ~30 —Å–µ–∫ | ~2 –º–∏–Ω |
| –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ (1 chunk) | ~0.01 —Å–µ–∫ | ~0.1 —Å–µ–∫ |
| –ü–æ–∏—Å–∫ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î | ~0.05 —Å–µ–∫ | ~0.05 —Å–µ–∫ |
| –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ (LLM) | ~2-5 —Å–µ–∫ | ~2-5 —Å–µ–∫ |

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **GPU:** RTX 3090 –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
- **Batch processing:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–∞–∫–µ—Ç–∞–º–∏ –ø–æ 10-20
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ Milvus

---

## –°—Ç–æ–∏–º–æ—Å—Ç—å

### RunPod Instance
- **Compute:** $0.46/—á–∞—Å (~$331/–º–µ—Å—è—Ü)
- **Storage (100 GB):** $0.0133/—á–∞—Å (~$10/–º–µ—Å—è—Ü)
- **–ò—Ç–æ–≥–æ:** ~$341/–º–µ—Å—è—Ü

### API (OpenRouter)
- **Claude 3.5 Sonnet:** $3/$15 –∑–∞ 1M tokens (input/output)
- **–û–∂–∏–¥–∞–µ–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** ~$50-100/–º–µ—Å—è—Ü

**–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:** ~$391-441/–º–µ—Å—è—Ü

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/aruxojuyu665/EvrazSosetHuiHAHAHAHAHA_CTO_VERSION_BITCHES  
**–í–µ—Ç–∫–∞:** RAG-Milvus-Manus-Edition  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** /workspace/gost_rag/docs/

---

## –°—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- ‚úÖ Python 3.11 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ
- ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ PyTorch —Å CUDA –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Milvus Lite —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –ö–æ–¥ –∑–∞–≥—Ä—É–∂–µ–Ω
- ‚è≥ API –∫–ª—é—á–∏ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- ‚è≥ –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫)
- ‚è≥ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API –∫–ª—é—á–µ–π!** üöÄ
